# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ —É–ª—É—á—à–µ–Ω–∏—è

## üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 1. API `/api/games` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
**–ü—Ä–æ–±–ª–µ–º–∞:** POST/PATCH/DELETE –æ–ø–µ—Ä–∞—Ü–∏–∏ –±—ã–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- GET –æ—Å—Ç–∞–≤–ª–µ–Ω —Å service token (–¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞)
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### 2. Middleware - –∑–∞—â–∏—Ç–∞ API routes
**–ü—Ä–æ–±–ª–µ–º–∞:** API routes –Ω–µ –±—ã–ª–∏ –∑–∞—â–∏—â–µ–Ω—ã middleware.
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω —Å–ø–∏—Å–æ–∫ –∑–∞—â–∏—â—ë–Ω–Ω—ã—Ö API –ø—É—Ç–µ–π
- API routes —Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç 401 –≤–º–µ—Å—Ç–æ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞
- Page routes –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É —Ä–µ–¥–∏—Ä–µ–∫—Ç—è—Ç –Ω–∞ –ª–æ–≥–∏–Ω

### 3. Security Headers
**–î–æ–±–∞–≤–ª–µ–Ω—ã –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
- `X-Frame-Options: DENY`
- `X-Content-Type-Options: nosniff`
- `Referrer-Policy: strict-origin-when-cross-origin`

## üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–≥–æ–≤

### 4. Z-index –≤ schedule-table
**–ü—Ä–æ–±–ª–µ–º–∞:** `z-9` - –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ Tailwind.
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –ó–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ `z-10`.

### 5. React Strict Mode
**–ü—Ä–æ–±–ª–µ–º–∞:** –ë—ã–ª –æ—Ç–∫–ª—é—á—ë–Ω, —á—Ç–æ —Å–∫—Ä—ã–≤–∞–ª–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã.
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –í–∫–ª—é—á—ë–Ω –æ–±—Ä–∞—Ç–Ω–æ.

## ‚ú® –£–ª—É—á—à–µ–Ω–∏—è

### 6. –¢–∏–ø–∏–∑–∞—Ü–∏—è –∏ Error Handling
**–§–∞–π–ª:** `lib/directus.ts`
- –î–æ–±–∞–≤–ª–µ–Ω –∫–ª–∞—Å—Å `DirectusError` –¥–ª—è —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫
- –£–±—Ä–∞–Ω—ã `any` —Ç–∏–ø—ã
- –î–æ–±–∞–≤–ª–µ–Ω—ã generic —Ç–∏–ø—ã –¥–ª—è `directusFetch<T>`

### 7. API Client —Å retry –ª–æ–≥–∏–∫–æ–π
**–§–∞–π–ª:** `lib/api-client.ts`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π retry –ø—Ä–∏ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–∫–∞—Ö
- Timeout –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤
- –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ (ApiError, NetworkError, TimeoutError)
- –£–¥–æ–±–Ω—ã–µ –º–µ—Ç–æ–¥—ã: `api.get`, `api.post`, `api.patch`, `api.delete`

### 8. Error Boundary
**–§–∞–π–ª:** `components/error-boundary.tsx`
- –ü–µ—Ä–µ—Ö–≤–∞—Ç –æ—à–∏–±–æ–∫ React
- Fallback UI —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é retry
- –ü–æ–∫–∞–∑ –¥–µ—Ç–∞–ª–µ–π –æ—à–∏–±–∫–∏ –≤ dev —Ä–µ–∂–∏–º–µ

### 9. Loading Spinner
**–§–∞–π–ª:** `components/loading-spinner.tsx`
- –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∑–∞–≥—Ä—É–∑–∫–∏
- –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å (aria-label, sr-only)

### 10. –£–ª—É—á—à–µ–Ω–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ª–æ–≥–∏–Ω–∞
**–§–∞–π–ª:** `app/login/login-client.tsx`
- –í–∞–ª–∏–¥–∞—Ü–∏—è email –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
- –£–ª—É—á—à–µ–Ω–Ω–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å (label for, autocomplete)
- Disabled —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª–µ–π –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
- –õ—É—á—à–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

### 11. –£–ª—É—á—à–µ–Ω–Ω—ã–π Games Admin
**–§–∞–π–ª:** `components/games-admin.tsx`
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- useCallback –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π

### 12. Layout —É–ª—É—á—à–µ–Ω–∏—è
**–§–∞–π–ª:** `app/layout.tsx`
- Error Boundary –æ–±—ë—Ä—Ç–∫–∞
- Viewport meta export
- –ò–∑–º–µ–Ω—ë–Ω lang –Ω–∞ "ru"

## üìÅ –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã

```
lib/api-client.ts          # Safe fetch —Å retry
lib/hooks/use-auth-redirect.ts  # –•—É–∫ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ 401
components/error-boundary.tsx   # React Error Boundary
components/loading-spinner.tsx  # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∑–∞–≥—Ä—É–∑–∫–∏
docs/CHANGES.md            # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üîß –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

```
app/api/games/route.ts     # + –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
app/login/login-client.tsx # + –≤–∞–ª–∏–¥–∞—Ü–∏—è, –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
app/layout.tsx             # + Error Boundary, viewport
components/games-admin.tsx # + error handling
components/schedule-table.tsx  # z-index fix
lib/directus.ts            # + —Ç–∏–ø–∏–∑–∞—Ü–∏—è, DirectusError
middleware.ts              # + –∑–∞—â–∏—Ç–∞ API
next.config.ts             # + strict mode, security headers
```

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –±—É–¥—É—â–µ–µ

1. **–î–æ–±–∞–≤–∏—Ç—å rate limiting** –Ω–∞ API routes
2. **CSRF —Ç–æ–∫–µ–Ω—ã** –¥–ª—è —Ñ–æ—Ä–º
3. **Input sanitization** –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
4. **Unit —Ç–µ—Å—Ç—ã** –¥–ª—è API routes
5. **E2E —Ç–µ—Å—Ç—ã** –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö user flows
6. **Logging** —Å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–º–∏ ID
